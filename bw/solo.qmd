---
title: "solo"
format: html
---

```{r}
library(ggplot2)
library(sf)
library(tidyverse)
library(dplyr)
library(rnaturalearth)

COVID_AU <- read_csv("~/Downloads/COVID_AU_state.csv")
```

```{r}
AU_map <- read_sf("~/Downloads/australia_Australia_Country_Boundary_MAPOG/australia_Australia_Country_Boundary.shp")
```

```{r}
AU_states <- COVID_AU |>
  group_by(state) |>
  summarize(confirmed_total = sum(confirmed),
            vaccines_total = sum(vaccines))
head(AU_states)
```


```{r}
ne_states(country = 'australia', returnclass = 'sf') |>
  select(name, geometry) |>
  left_join(AU_states, join_by(name == state)) |>
ggplot() +
  geom_sf(aes(fill = confirmed_total),color = "white")+
  labs(title = "Confirmed COVID-19 Cases in Australia", 
       fill = "Confirmed Cases") +
  theme_minimal() 

ne_states(country = 'australia', returnclass = 'sf') |>
  select(name, geometry) |>
  left_join(AU_states, join_by(name == state)) |>
ggplot() +
  geom_sf(aes(fill = vaccines_total), color = "white") +
  labs(title = "COVID-19 Vaccine Distribution in Australia", 
       fill = "Total Vaccine Injection") +
  theme_minimal()

```

### Explanation
This choropleth map of Australia visualizes the confirmed cases by state. The color intensity of each state indicates the total number of vaccines administered, with lighter colors representing higher coverage. From the plot, we observe that the states on the east coast have more cases that the other states.

```{r}
AU_combined <- ne_states(country = 'australia', returnclass = 'sf') |>
  select(name, geometry) |>
  left_join(AU_states, join_by(name == state))

AU_centroids <- st_centroid(AU_combined)

ggplot() +
  geom_sf(data = AU_combined, aes(fill = vaccines_total), color = "white", size = 0.5) +
  geom_sf(data = AU_centroids,aes(size = confirmed_total), color = "black", alpha = 0.7) +
  scale_fill_viridis_c(option = "C", name = "Vaccines Administered") +
  labs(title = "COVID-19 Confirmed Cases and Vaccine Distribution in Australia", 
       fill = "Counts") +
  theme_minimal()
```

### Explanation
This choropleth map of Australia visualizes the relationship between COVID-19 vaccine distribution and confirmed cases by state. The color intensity of each state indicates the total number of vaccines administered, with lighter colors representing higher coverage. The black circles represent the total number of confirmed COVID-19 cases, with larger circles indicating more cases. From the plot, we observe that states with the highest confirmed cases also received greater vaccine distribution.

